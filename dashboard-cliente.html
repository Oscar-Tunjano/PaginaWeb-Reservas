<!DOCTYPE html>
const tr = document.createElement("tr");


tr.innerHTML = `
<td>${r.id}</td>
<td>${formatearFecha(r.fecha_inicio)}</td>
<td>${formatearFecha(r.fecha_fin)}</td>
<td>${r.propiedad}</td>
<td>${r.estado}</td>
<td>
<button class="cancelar-btn" onclick="cancelarReserva(${r.id})">
Cancelar
</button>
</td>
`;


tbody.appendChild(tr);
});


} catch (error) {
console.error("Error cargando reservas:", error);
tbody.innerHTML = `<tr><td colspan="6">Error al conectar con el servidor.</td></tr>`;
}
}


// ==========================================
// CANCELAR RESERVA
// ==========================================
async function cancelarReserva(id) {
if (!confirm(`¿Seguro que deseas cancelar la reserva #${id}?`)) return;


try {
const response = await fetch(`${API}/api/reservas/${id}`, {
method: "DELETE",
credentials: "include"
});


if (!response.ok) {
alert("Error al cancelar la reserva.");
return;
}


alert("Reserva cancelada correctamente.");
cargarReservas();


} catch (err) {
console.error(err);
alert("Error al conectar con el servidor.");
}
}


// ==========================================
// CERRAR SESIÓN
// ==========================================
function logout() {
fetch(`${API}/api/auth/logout`, {
method: "POST",
credentials: "include"
}).finally(() => {
localStorage.removeItem("userEmail");
localStorage.removeItem("userRole");
window.location.href = "index.html";
});
}


// ==========================================
// IMAGEN ROL
// ==========================================
document.getElementById("roleImage").innerHTML = `
<svg width="100" height="60">
<rect width="100" height="60" fill="#29f"></rect>
<text x="50" y="35" font-size="12" text-anchor="middle" fill="#fff">
CLIENTE
</text>
</svg>
`;


// ==========================================
// INICIAR
// ==========================================
cargarReservas();
</script>


</body>
</html>